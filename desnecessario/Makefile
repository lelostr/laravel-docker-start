# Makefile para o projeto Alfred
# Comandos Ãºteis para desenvolvimento

.PHONY: help install start stop restart logs shell test clean build

# Comando padrÃ£o
help:
	@echo "ğŸš€ Comandos disponÃ­veis para o projeto Alfred:"
	@echo ""
	@echo "ğŸ“¦ InstalaÃ§Ã£o e ConfiguraÃ§Ã£o:"
	@echo "  make install    - Instalar e configurar o projeto"
	@echo "  make start      - Iniciar containers"
	@echo "  make stop       - Parar containers"
	@echo "  make restart    - Reiniciar containers"
	@echo ""
	@echo "ğŸ”§ Desenvolvimento:"
	@echo "  make shell      - Acessar container da aplicaÃ§Ã£o"
	@echo "  make logs       - Ver logs dos containers"
	@echo "  make test       - Executar testes"
	@echo ""
	@echo "ğŸ§¹ Limpeza:"
	@echo "  make clean      - Limpar containers e volumes"
	@echo "  make build      - Reconstruir containers"

# InstalaÃ§Ã£o e configuraÃ§Ã£o
install:
	@echo "ğŸš€ Instalando e configurando o projeto Alfred..."
	@./setup.sh

# Iniciar containers
start:
	@echo "ğŸ³ Iniciando containers..."
	@docker compose up -d

# Parar containers
stop:
	@echo "ğŸ›‘ Parando containers..."
	@docker compose down

# Reiniciar containers
restart: stop start
	@echo "ğŸ”„ Containers reiniciados!"

# Ver logs
logs:
	@echo "ğŸ“‹ Exibindo logs dos containers..."
	@docker compose logs -f

# Acessar shell do container
shell:
	@echo "ğŸš Acessando shell do container da aplicaÃ§Ã£o..."
	@docker compose exec app bash

# Executar testes
test:
	@echo "ğŸ§ª Executando testes..."
	@docker compose exec app php artisan test

# Limpar containers e volumes
clean:
	@echo "ğŸ§¹ Limpando containers e volumes..."
	@docker compose down -v --remove-orphans
	@docker system prune -f

# Reconstruir containers
build:
	@echo "ğŸ”¨ Reconstruindo containers..."
	@docker compose up -d --build

# Comandos Laravel especÃ­ficos
migrate:
	@echo "ğŸ—„ï¸  Executando migraÃ§Ãµes..."
	@docker compose exec app php artisan migrate

seed:
	@echo "ğŸŒ± Executando seeders..."
	@docker compose exec app php artisan db:seed

fresh:
	@echo "ğŸ”„ Recriando banco de dados..."
	@docker compose exec app php artisan migrate:fresh --seed

cache:
	@echo "ğŸ’¾ Limpando cache..."
	@docker compose exec app php artisan cache:clear
	@docker compose exec app php artisan config:clear
	@docker compose exec app php artisan route:clear
	@docker compose exec app php artisan view:clear

# Comandos de produÃ§Ã£o
prod:
	@echo "ğŸš€ Iniciando em modo produÃ§Ã£o..."
	@docker compose -f docker-compose.prod.yml up -d --build

prod-stop:
	@echo "ğŸ›‘ Parando modo produÃ§Ã£o..."
	@docker compose -f docker-compose.prod.yml down
